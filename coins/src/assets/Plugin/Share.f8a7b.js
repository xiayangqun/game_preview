window.Share={isEnabled:!0,_cb:null,_defaultTitle:"\u4ec0\u4e48\uff1f\u7adf\u6709\u602a\u7269\u514d\u8d39\u5e2e\u4f60\u8d5a\u91d1\u5e01\uff01",_defaultImageUrl:"https://lg-3nqpo5im-1258319683.cos.ap-shanghai.myqcloud.com/shareImg/defaultShare.png",_shareArrays:[],init:function(e){this._shareArrays=e,cc.sys.platform==cc.sys.WECHAT_GAME&&(wx.showShareMenu({}),wx.aldOnShareAppMessage?wx.aldOnShareAppMessage(function(){return this.getShareItem()}.bind(this)):wx.onShareAppMessage(function(){return this.getShareItem()}.bind(this)))},share:function(e,t,s,a){if(this._cb=e,this._shareType=a,a&&LocalData[a]<=0)return this._cb&&this._cb("\u4eca\u65e5\u5206\u4eab\u5956\u52b1\u6b21\u6570\u5df2\u8fbe\u4e0a\u9650"),void(this._cb=null);if(this._trackEventName=t,this._trackObj=s,cc.sys.platform==cc.sys.WECHAT_GAME){cc.log("\u5f00\u59cb\u5206\u4eab\u4e86");let e=this.getShareItem();boatSDK.showShare(e.title,e.imageUrl,e.query).then(()=>{NC.removeObserver(NC.KEY.ON_GAME_SHOW,this),NC.addObserver(NC.KEY.ON_GAME_SHOW,this.onGameShow,this)})}else cc.log("\u5f00\u59cb\u5206\u4eab\u4e86"),this.onGameShow()},onGameShow:function(){NC.removeObserver(NC.KEY.ON_GAME_SHOW,this),null!=this._cb&&(0==Math.random()<.3?(this._shareType&&(LocalData[this._shareType]--,this._shareType=null),this._cb(null),this._trackEventName&&cc.sys.platform==cc.sys.WECHAT_GAME&&(boatSDK.ald.sendEvent(this._trackEventName,this._trackObj),this._trackEventName=null)):this._cb("\u8bf7\u5206\u4eab\u5230\u4e0d\u540c\u7684\u7fa4"),this._cb=null)},getShareItem:function(){let e={},t={fromId:LocalData.wxUserInfo.id},s=Utils.converObjectToQuery(t);if(e.query=s,0==this._shareArrays.length)e.title=this._defaultTitle,e.imageUrl=this._defaultImageUrl;else{let t=_.sample(this._shareArrays);e.title=t.title,e.imageUrl=t.imageUrl}return cc.log("\u83b7\u53d6\u5206\u4eab\u7684\u6761\u76ee",e),e}};